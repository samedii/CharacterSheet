<!DOCTYPE html>
<html>

<head>

    <title>Sheet</title>
    <meta charset="utf-8" />

    <style>
    @font-face {
        font-family:"titleFont";
        src: url("EG_Dragon_Caps.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
    }
    @font-face {
        font-family:"textFont";
        src: url("Jellyka_Estrya_Handwriting.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
    }
    html {
        font-family:"textFont", sans-serif;
        font-size: 50px;
        line-height: 30px;
        color: white;
        -webkit-font-smoothing: antialiased;
        font-smooth:always;
    }
    body {
        background-color: black;
        background-image: url(bg.png);
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center 112px;
        margin: 0;
    }
    #top {
        background: url(top.png) no-repeat scroll;
        background-size: 854px 957px;
        background-position: 0 0;
        width: 854px;
        margin: 0 auto 0 auto;
        position: relative;
    }
    #repeat {
        background: url(repeat.png) repeat-y scroll;
        background-size: auto;
        position: absolute;
        top: 957px;
        bottom: 0;
        left: 0;
        right: 0;
    }
    #bot {
        background-image: url(bot.png);
        background-repeat: no-repeat;
        background-attachment: scroll;
        background-position: top left;
        width: 854px;
        height: 125px;
        margin: -15px auto 0 auto;
    }
    input {
        font-family: inherit;
        display: inline;
        border: 0 transparent;
        background-color: transparent;
        font-size: inherit;
        color: inherit;
        margin: 0;
        padding: 0 !important;
        overflow-x: visible;
        width: 10px;
    }
    textarea {
        font-family: inherit;
        font-size: 12px;
        display: inline;
        border: 0 transparent;
        background-color: transparent;
        font-size: inherit;
        color: inherit;
        margin: 0;
        padding: 0 !important;
        overflow-x: visible;
        width: 100%;
        resize: none;
        line-height: inherit;
    }
    h1 {
        font-family:"titleFont";
        font-size: 30px;
        font-weight: normal;
    }
    h2 {
        font-family:"titleFont";
        font-size: 16px;
        font-weight: normal;
        margin: 0;
    }
    h3 {
        font-family:"titleFont";
        font-size: 12px;
        font-weight: normal;
        margin: 0;
    }
    label {
        font-family:"titleFont";
        font-size: 12px;
        vertical-align: middle;
    }
    label input {
        font-family:"textFont";
        font-size: 40px;
        vertical-align: middle;
    }
    .characteristics {
        width: 40%;
        float: left;
    }
    .characteristics label {
        display: inline-block;
        width: 100%;
        position: relative;
    }
    .characteristics label>input {
        position: absolute;
        right: 0px;
    }
    </style>

    <!-- Include AngularJS from Google's CDN -->

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.17/angular.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.17/angular-resource.js"></script>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.17/angular-animate.min.js"></script>-->

</head>

<body ng-app="Sheet">
    <div id="top" resizes-to-fit-bg>
        <div style="padding:150px 150px 0 150px; height: 100%">
            <div style="position:relative; height: 120px">
                <h1>
                    <input type="text" placeholder="Rollpersonens namn" value="Joar Stenhamn" style="min-width: 320px" />
                </h1>
                <label style="font-size: 14px; position: absolute; bottom: 0; right: 0;">Spelare:
                    <input type="text" placeholder="Namn" value="Richard Hermanson" style="min-width: 65px; font-size: 60px" />
                </label>
            </div>
            <div>
                <h2 style="margin: -30px 0 0 0">Beskrivning</h2>
                <textarea style="margin: 4px 4px 20px 4px;" placeholder="Karaktärsbeskrivning" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">Min karaktärsbeskrivning följer efter denna text och den fortsätter och forrtsättter tills det blir ny rad och då ser vi vad som händer. Med alla mina rader.</textarea>
            </div>
            <div style="clear: both">
                <div class="characteristics" style="width: 40%; float: left">
                    <h2>Karaktäriseringar</h2>
                    <div>
                        <label>Fysik
                            <input type="text" placeholder="" value="***" />
                        </label>
                    </div>
                    <div>
                        <label>Psyke
                            <input type="text" placeholder="" value="**" />
                        </label>
                    </div>
                    <div>
                        <label>Smidighet
                            <input type="text" placeholder="" value="*****" />
                        </label>
                    </div>
                </div>
            </div>
            <div style="width: 60%; float: right; text-align: right">
                <h2>Äventyrspoäng</h2>
                <label>Totalt
                    <input type="text" placeholder="" value="67" style="min-width: 60px" />
                </label>
                <label style="text-align: right">Nya
                    <input type="text" placeholder="" value="10" style="min-width: 10px" />
                </label>
            </div>
        </div>

        <div id="repeat"></div>
    </div>
    <div id="bot"></div>

    <script type="text/javascript">
    angular.module("Sheet", [])
        .directive("input", [
            "$interval",
            function($interval) {
                return {
                    restrict: "E",
                    link: function(scope, element) {
                        var e = element[0];

                        function setWidth() {
                            element.css("width", e.scrollWidth + "px");
                        }

                        function resetWidth() {
                            element.css("width", 0);
                            $interval(setWidth, 10, 20)
                        }

                        resetWidth();

                        element.on("input", function() {
                            setWidth();
                            e.defaultValue = e.value;
                        });

                        element.on("change", function() {
                            resetWidth();
                            e.defaultValue = e.value;
                        });
                    }
                };
            }
        ])
        .directive("textarea", [
            "$interval",
            function($interval) {
                return {
                    restrict: "E",
                    link: function(scope, element) {
                        var e = element[0];

                        function setHeight() {
                            element.css("height", e.scrollHeight + "px");
                        }

                        function resetHeight() {
                            element.css("height", 0);
                            $interval(setHeight, 10, 20);
                        }

                        resetHeight();

                        element.on("input", function() {
                            setHeight();
                            e.defaultValue = e.value;
                        });

                        element.on("change", function() {
                            resetHeight();
                            e.defaultValue = e.value;
                        });

                    }
                };
            }
        ])
        .constant("topHeight", 957)
        .constant("repeatHeight", 213)
        .directive("resizesToFitBg", [
            "topHeight",
            "repeatHeight",
            function(topHeight, repeatHeight) {
                return {
                    link: function(scope, element) {
                        var e = element[0];

                        function resize() {

                            var height = e.clientHeight;

                            if (height <= topHeight) {
                                e.style.minHeight = (topHeight + repeatHeight) + "px";
                            } else {
                                var extraHeight = height - topHeight;
                                var extra = extraHeight / repeatHeight;
                                e.style.minHeight = (topHeight + Math.ceil(extra) * repeatHeight) + "px";
                            }
                        }

                        resize();
                    }
                }
            }
        ]);
    </script>
</body>

</html>
